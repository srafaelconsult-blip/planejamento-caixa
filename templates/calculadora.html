function addLinhaTabela(valores, isMonetary = true) {
    if (!valores || !Array.isArray(valores)) {
        console.error('Valores inválidos:', valores);
        return '<td>N/A</td>'.repeat(5) + '<td><strong>N/A</strong></td>';
    }
    
    try {
        // Garantir que todos os valores são números
        const valoresNumericos = valores.map(v => {
            const num = typeof v === 'number' ? v : parseFloat(v);
            return isNaN(num) ? 0 : num;
        });
        
        const total = valoresNumericos.reduce((sum, val) => sum + val, 0);
        
        const celulas = valoresNumericos.map(v => {
            if (isMonetary) {
                return `<td>${formatarMoeda(v)}</td>`;
            } else {
                return `<td>${v.toFixed(2)}</td>`;
            }
        }).join('');
        
        if (isMonetary) {
            return celulas + `<td><strong>${formatarMoeda(total)}</strong></td>`;
        } else {
            return celulas + `<td><strong>${total.toFixed(2)}</strong></td>`;
        }
    } catch (error) {
        console.error('Erro ao processar valores:', error, valores);
        return '<td>Erro</td>'.repeat(5) + '<td><strong>Erro</strong></td>';
    }
}
