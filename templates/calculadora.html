<script>
    // ... (código anterior permanece igual)
    
    // Atualizar tabela
    function atualizarTabela(resultados, meses) {
        const container = document.getElementById('tabela-resultados');
        let html = '<table>';
        
        // Cabeçalho
        html += '<tr><th>Descrição</th>';
        meses.forEach(mes => {
            html += `<th>${mes}</th>`;
        });
        html += '</tr>';
        
        // Dados na ordem correta (agora resultados é uma lista de arrays)
        resultados.forEach(linha => {
            const key = linha[0];
            const values = linha.slice(1);
            
            if (key.trim() === '') {
                // Linha em branco
                html += `<tr class="empty-row"><td colspan="${meses.length + 1}"></td></tr>`;
            } else {
                // Dados normais
                html += `<tr><td>${key}</td>`;
                values.forEach(valor => {
                    html += `<td>${valor}</td>`;
                });
                html += '</tr>';
            }
        });
        
        html += '</table>';
        container.innerHTML = html;
    }
    
    // ... (restante do código JavaScript permanece igual)
</script>
