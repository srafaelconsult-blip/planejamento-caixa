<!-- Adicione este CSS para a tabela de resultados -->
<style>
    .result-table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        font-size: 14px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    }
    
    .result-table th {
        background: linear-gradient(135deg, #4361ee 0%, #3a56d4 100%);
        color: white;
        text-align: left;
        padding: 12px 15px;
        position: sticky;
        top: 0;
    }
    
    .result-table td {
        padding: 10px 15px;
        border-bottom: 1px solid #e2e8f0;
    }
    
    .result-table tr:nth-child(even) {
        background-color: #f8f9fa;
    }
    
    .result-table tr:hover {
        background-color: #f1f3f5;
    }
    
    .result-table .section-header {
        background: linear-gradient(135deg, #7209b7 0%, #5a0892 100%);
        color: white;
        font-weight: bold;
        font-size: 16px;
    }
    
    .result-table .subtotal {
        background-color: #e8f5e8;
        font-weight: bold;
    }
    
    .result-table .total {
        background: linear-gradient(135deg, #06d6a0 0%, #05b98a 100%);
        color: white;
        font-weight: bold;
        font-size: 16px;
    }
    
    .result-table .negative {
        color: #ef476f;
    }
    
    .result-table .positive {
        color: #06d6a0;
    }
    
    .numeric {
        text-align: right;
        font-family: 'Courier New', monospace;
    }
</style>

<!-- Atualize a função exibirTabela no JavaScript -->
<script>
    function exibirTabela(resultados, meses) {
        const table = document.getElementById('resultTable');
        table.innerHTML = '';
        table.className = 'result-table';
        
        // Cabeçalho
        let headerRow = '<tr><th style="width: 300px;">Categoria</th>';
        for (let i = 0; i < meses.length; i++) {
            headerRow += `<th>${meses[i]}</th>`;
        }
        headerRow += '</tr>';
        table.innerHTML = headerRow;
        
        // Dados
        for (const [categoria, valores] of Object.entries(resultados)) {
            let row = '';
            let rowClass = '';
            
            if (categoria.includes('---')) {
                // É um separador
                row = `<tr class="section-header"><td colspan="${valores.length + 1}">${categoria.replace('---', '').replace('---', '')}</td></tr>`;
            } else if (categoria.includes('Total') || categoria.includes('SALDO')) {
                // É um total ou saldo
                rowClass = categoria.includes('SALDO') ? 'total' : 'subtotal';
                row = `<tr class="${rowClass}"><td>${categoria}</td>`;
                for (let i = 0; i < valores.length; i++) {
                    const valueClass = valores[i].startsWith('R$ -') ? 'negative' : 'positive';
                    row += `<td class="numeric ${valueClass}">${valores[i]}</td>`;
                }
                row += '</tr>';
            } else if (categoria.startsWith('(+)') || categoria.startsWith('(-)')) {
                // É uma adição ou subtração
                const valueClass = categoria.startsWith('(-)') ? 'negative' : 'positive';
                row = `<tr><td>${categoria}</td>`;
                for (let i = 0; i < valores.length; i++) {
                    row += `<td class="numeric ${valueClass}">${valores[i]}</td>`;
                }
                row += '</tr>';
            } else {
                // É uma linha normal
                row = `<tr><td>${categoria}</td>`;
                for (let i = 0; i < valores.length; i++) {
                    row += `<td class="numeric">${valores[i]}</td>`;
                }
                row += '</tr>';
            }
            
            table.innerHTML += row;
        }
    }
</script>
