                            backgroundColor: 'rgba(40, 167, 69, 0.8)',
                            borderColor: 'rgba(40, 167, 69, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Despesas',
                            data: graficos.despesas,
                            backgroundColor: 'rgba(220, 53, 69, 0.8)',
                            borderColor: 'rgba(220, 53, 69, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Receitas vs Despesas - 5 Meses'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Valor (R$)'
                            }
                        }
                    }
                }
            });
        }
        
        // Atualizar tabela - FUNÇÃO CORRIGIDA
        function atualizarTabela(resultados, meses) {
            const container = document.getElementById('tabela-resultados');
            let html = '<table>';
            
            // Cabeçalho
            html += '<tr><th>Descrição</th>';
            meses.forEach(mes => {
                html += `<th>${mes}</th>`;
            });
            html += '</tr>';
            
            // Verificar se resultados é um array
            if (!Array.isArray(resultados)) {
                console.error('Resultados não é um array:', resultados);
                html += '<tr><td colspan="' + (meses.length + 1) + '">Erro: Formato de dados inválido</td></tr>';
                container.innerHTML = html;
                return;
            }
            
            // Dados na ordem correta
            resultados.forEach(linha => {
                if (!Array.isArray(linha)) {
                    console.error('Linha não é um array:', linha);
                    return;
                }
                
                const key = linha[0] || '';
                const values = linha.slice(1, meses.length + 1); // Pegar apenas os valores dos meses
                const total = linha[linha.length - 1]; // Último elemento é o total
                
                if (key.trim() === '') {
                    // Linha em branco
                    html += `<tr class="empty-row"><td colspan="${meses.length + 1}"></td></tr>`;
                } else {
                    // Dados normais
                    html += `<tr><td>${key}</td>`;
                    
                    // Valores dos meses
                    values.forEach(valor => {
                        html += `<td>${valor || ''}</td>`;
                    });
                    
                    // Valor total
                    html += `<td>${total || ''}</td>`;
                    
                    html += '</tr>';
                }
            });
            
            html += '</table>';
            container.innerHTML = html;
        }
        
        // Inicializar página
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('user-email').textContent = getUserEmail();
            checkSubscription();
            
            // Adicionar event listeners para os inputs
            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('input', function() {
                    // Habilitar/desabilitar botão baseado em preenchimento
                    const todasPreenchidas = Array.from(inputs).every(i => i.value !== '');
                    document.querySelector('.calculate-btn').disabled = !todasPreenchidas;
                });
            });
        });
    </script>
</body>
</html>
